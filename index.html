<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="ai-chatbot-container" class="chatbot">
        <div id="ai-chat-messages" class="messages"></div>
        <form id="ai-chat-form">
            <input type="text" id="ai-chat-input" placeholder="Digite sua mensagem..." required>
            <button type="submit">Enviar</button>
        </form>
    </div>

    <script>
        // Função para alternar a abertura/fechamento do chatbot
        function toggleChatbot() {
            const bot = document.getElementById('ai-chatbot-container');
            if(bot.classList.contains('open')) {
                bot.classList.remove('open');
            } else {
                bot.classList.add('open');
                document.getElementById('ai-chat-input').focus();
            }
        }

        // Função auxiliar para adicionar mensagem ao chat visualmente
        function addChatMessage(author, text) {
            const messageBox = document.getElementById('ai-chat-messages');
            const msgDiv = document.createElement('div');
            msgDiv.style.marginBottom = '12px';
            msgDiv.style.display = 'flex';
            msgDiv.style.justifyContent = author === 'user' ? 'flex-end' : 'flex-start';

            const bubble = document.createElement('div');
            bubble.textContent = text;
            bubble.style.padding = '8px 14px';
            bubble.style.borderRadius = '18px';
            bubble.style.maxWidth = '75%';
            bubble.style.wordBreak = 'break-word';
            bubble.style.background = author === 'user' ? '#0D47A1' : '#f3f3f3';
            bubble.style.color = author === 'user' ? '#fff' : '#222';
            bubble.style.fontSize = '15px';
            bubble.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08)';

            msgDiv.appendChild(bubble);
            messageBox.appendChild(msgDiv);
            messageBox.scrollTop = messageBox.scrollHeight;
        }

        // Função para simular resposta da IA (substitua por chamada real na produção)
        function getSimulatedResponse(message) {
            // Aqui pode-se colocar regras simples para respostas simuladas
            if(message.toLowerCase().includes('kelly')) return 'O critério de Kelly indica quanto da sua banca apostar em uma aposta com valor. Você precisa informar sua probabilidade real e a odd!';
            if(message.toLowerCase().includes('ev')) return 'EV (Valor Esperado) = (Probabilidade * Odd) - 1. Aposte apenas com EV positivo!';
            if(message.toLowerCase().includes('odd')) return 'Odds representam a probabilidade multiplicada pelo retorno. Use odds para calcular o valor esperado!';
            return 'Sou uma IA simulada neste teste! Pergunte sobre estratégias de aposta, EV+, Kelly, odds, etc.';
        }

        // Gerenciamento do formulário de chat
        const chatForm = document.getElementById('ai-chat-form');
        if(chatForm) {
            chatForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const input = document.getElementById('ai-chat-input');
                const userMsg = input.value.trim();
                if(!userMsg) return;
                addChatMessage('user', userMsg);
                input.value = '';
                // IA "pensando"...
                setTimeout(function() {
                    const reply = getSimulatedResponse(userMsg);
                    addChatMessage('bot', reply);
                }, 700);
            });
        }
        // Fecha o chatbot ao pressionar ESC
        window.addEventListener('keydown', function(e){
            if(e.key === 'Escape') {
                document.getElementById('ai-chatbot-container').classList.remove('open');
            }
        });
    </script>
</body>
</html>